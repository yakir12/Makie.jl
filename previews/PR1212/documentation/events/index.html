<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/previews/PR1212/libs/highlight/github.min.css"> <link rel=stylesheet  href="/previews/PR1212/css/franklin.css"> <link rel=stylesheet  href="/previews/PR1212/css/minimal-mistakes.css"> <link rel=stylesheet  href="/previews/PR1212/css/makie.css"> <link rel=icon  href="/previews/PR1212/assets/icon_transparent.png"> <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel=stylesheet  type="text/css"/> <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel=stylesheet  type="text/css"/> <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel=stylesheet  type="text/css"/> <!--[if IE ]> <style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; } </style> <![endif]--> <title>Events</title> <body class=layout--single > <div class=masthead > <div class=masthead__inner-wrap > <div class=masthead__menu > <nav id=site-nav  class=greedy-nav > <a class=title-icon  href="/previews/PR1212/"><img src="/previews/PR1212/assets/makie_logo_transparent.svg"/></a> <ul class=visible-links > <li class=masthead__menu-item > <a href="https://github.com/JuliaPlots/Makie.jl"><img src="/previews/PR1212/assets/GitHub-Mark-64px.png" class=masthead-icon  /></a> <li class=masthead__menu-item ><a href="/previews/PR1212/examples/">Examples</a> <li class=masthead__menu-item ><a href="/previews/PR1212/tutorials/">Tutorials</a> <li class=masthead__menu-item ><a href="/previews/PR1212/documentation/">Documentation</a> </ul> <button class="greedy-nav__toggle hidden" type=button > <span class=visually-hidden >Toggle menu</span> <div class=navicon ></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class=initial-content > <div id=main  role=main > <div class=franklin-content ><h1 id=events ><a href="#events" class=header-anchor >Events</a></h1> <p>Interactive backends such as <code>GLMakie</code> and <code>WGLMakie</code> pass events to an <code>Events</code> struct in the currently active scene. There they trigger a number of slightly modified observables of type <code>PriorityObservable</code>. By reacting to those one can build up custom interactions.</p> <h2 id=priorityobservables ><a href="#priorityobservables" class=header-anchor >PriorityObservables</a></h2> <p>Much like the name suggests a <code>PriorityObservable</code> adds a priority to its listeners. Furthermore it allows for each listener to stop execution of lower priority listeners by returning <code>Consume&#40;true&#41;</code> or simply <code>Consume&#40;&#41;</code>. Every other return value will be handled as <code>Consume&#40;false&#41;</code> meaning that the listener does not block other listeners.</p> <p>To understand how a <code>PriorityObserable</code> works you may try this example:</p> <pre><code class=language-julia >using Makie: PriorityObservable

po &#61; PriorityObservable&#40;0&#41;

on&#40;po, priority &#61; -1&#41; do x
    println&#40;&quot;Low priority: &#36;x&quot;&#41;
end
po&#91;&#93; &#61; 1

on&#40;po, priority &#61; 0&#41; do x
    println&#40;&quot;Medium blocking priority: &#36;x&quot;&#41;
    return Consume&#40;&#41;
end
po&#91;&#93; &#61; 2

on&#40;po, priority &#61; 1&#41; do x
    println&#40;&quot;High Priority: &#36;x&quot;&#41;
    return Consume&#40;false&#41;
end
po&#91;&#93; &#61; 3</code></pre> <p>With only the first listener connected you should see <code>Low priority: 1</code> getting printed. With the second you should only see a reaction from the medium priority listener, as it blocks execution of the lower priority by returning <code>Consume&#40;&#41;</code>. With all three connected you should see two prints, first the high priority, than the medium priority.</p> <h2 id=the_events_struct ><a href="#the_events_struct" class=header-anchor >The Events struct</a></h2> <p>Events from the backend are stored in <code>PriorityObservables</code> within the <code>Events</code> struct. You can access it from any scene via <code>events&#40;scene&#41;</code> and via <code>events&#40;figure.scene&#41;</code> or <code>events&#40;axis.scene&#41;</code> from a figure or axis. The struct contains the following fields you may react to.</p> <ul> <li><p><code>window_area::PriorityObservable&#123;IRect2D&#125;</code>: Contains the current size of the window in pixels.</p> <li><p><code>window_dpi::PriorityObservable&#123;Float64&#125;</code>: Contains the DPI of the window.</p> <li><p><code>window_open::PriorityObservable&#123;Bool&#125;</code>: Contains <code>true</code> as long as the window is open.</p> <li><p><code>hasfocus::PriorityObservable&#123;Bool&#125;</code>: Contains <code>true</code> if the window is focused &#40;in the foreground&#41;.</p> <li><p><code>entered_window::PriorityObservable&#123;Bool&#125;</code>: Contains true if the mouse is within the window &#40;regarless of whether it is focused&#41;, i.e. when it is hovered.</p> <li><p><code>mousebutton::PriorityObservable&#123;MouseButtonEvent&#125;</code>: Contains the most recent <code>MouseButtonEvent</code> which holds the relevant <code>button::Mouse.Button</code> and <code>action::Mouse.Action</code>.</p> <li><p><code>mousebuttonstate::Set&#123;Mouse.Button&#125;</code>: Contains all currently pressed mouse buttons.</p> <li><p><code>mouseposition::PriorityObservable&#123;NTuple&#123;2, Float64&#125;&#125;</code>: Contains the most recent cursor position in pixel units relative to the root scene/window.</p> <li><p><code>scroll::PriorityObservable&#123;NTuple&#123;2, Float64&#125;&#125;</code>: Contains the most recent scroll offset.</p> <li><p><code>keyboardbutton::PriorityObservable&#123;KeyEvent&#125;</code>: Contains the most recent <code>KeyEvent</code> which holds the relevant <code>key::Keyboard.Button</code> and <code>action::Keyboard.Action</code>.</p> <li><p><code>keyboardstate::PriorityObservable&#123;Keyboard.Button&#125;</code>: Contains all currently pressed keys.</p> <li><p><code>unicode_input::PriorityObservable&#123;Char&#125;</code>: Contains the most recently typed character.</p> <li><p><code>dropped_files::PriorityObservable&#123;Vector&#123;String&#125;&#125;</code>: Contains a list of filepaths to a collection files dragged into the window.</p> </ul> <h2 id=mouse_interaction ><a href="#mouse_interaction" class=header-anchor >Mouse Interaction</a></h2> <p>There are three mouse events one can react to:</p> <ul> <li><p><code>events.mousebutton</code> which holds a <code>MouseButtonEvent</code> with relevant <code>button</code> and <code>action</code></p> <li><p><code>events.mouseposition</code> which holds the current cursor position relative to the window as <code>NTuple&#123;2, Float64&#125;</code> in pixel</p> <li><p><code>events.scroll</code> which holds an <code>NTuple&#123;2, Float64&#125;</code> of the last scroll change</p> </ul> <p>For example, we can react to a left click with:</p> <pre><code class=language-julia >on&#40;events&#40;fig&#41;.mousebutton, priority &#61; 0&#41; do event
    if event.button &#61;&#61; Mouse.left
        if event.action &#61;&#61; Mouse.press
            # do something
        else
            # do something else when the mouse button is released
        end
    end
    # Do not consume the event
    return Consume&#40;false&#41;
end</code></pre> <p>There are also a bunch of convenience function for mouse interactions:</p> <ul> <li><p><code>hovered_scene&#40;&#41;</code> returns the currently hovered scene.</p> <li><p><code>mouseposition_px&#40;&#91;scene&#93;&#41;</code> returns the cursor position in pixel units relative to the given or currently hovered scene.</p> <li><p><code>mouseposition&#40;&#91;scene&#93;&#41;</code> returns the cursor position of the given or hovered scene in data coordinates.</p> <li><p><code>mouseover&#40;scene, plots...&#41;</code> returns true if the mouse is over any of the given plots.</p> <li><p><code>mouse_selection&#40;scene&#91;, range&#93;&#41;</code> returns the plot under your cursor.</p> <li><p><code>onpick&#40;f, scene, plots...&#91;; range&#61;1&#93;&#41;</code> allows you to define a callback <code>f</code> when one of the given plots is hovered &#40;or the closest within range of the cursor&#41;.</p> <li><p><code>pick&#40;scene, position&#91;, range&#93;&#41;</code> returns the plot under the given position &#40;or the closest within range&#41;</p> <li><p><code>Makie.pick_closest&#40;scene, position, range&#41;</code> returns all plots within range, sorted by distance to the given position.</p> </ul> <h2 id=keyboard_interaction ><a href="#keyboard_interaction" class=header-anchor >Keyboard Interaction</a></h2> <p>You can use <code>events.keyboardbutton</code> to react to a <code>KeyEvent</code> and <code>events.unicode_input</code> to react to specific characters being typed.</p> <p>For example we may react to specific keys being pressed or held with</p> <pre><code class=language-julia >on&#40;events&#40;fig&#41;.keyboardbutton&#41; do event
    if event.action in &#40;Keyboard.press, Keyboard.repeat&#41;
        event.key &#61;&#61; Keyboard.left   &amp;&amp; move_left&#40;&#41;
        event.key &#61;&#61; Keyboard.up     &amp;&amp; move_up&#40;&#41;
        event.key &#61;&#61; Keyboard.right  &amp;&amp; move_right&#40;&#41;
        event.key &#61;&#61; Keyboard.down   &amp;&amp; move_down&#40;&#41;
    end
    # Let the event reach other listeners
    return Consume&#40;false&#41;
end</code></pre> <h2 id=interactive_widgets ><a href="#interactive_widgets" class=header-anchor >Interactive Widgets</a></h2> <p>Makie has a couple of useful interactive widgets like sliders, buttons and menus, which you can read about in the <a href="/previews/PR1212/examples/layoutables/layoutables/index.html#layoutables">Layoutables</a> section.</p> <h2 id=recording_animations_with_interactions ><a href="#recording_animations_with_interactions" class=header-anchor >Recording Animations with Interactions</a></h2> <p>You can record a <code>Scene</code> while you&#39;re interacting with it. Just use the <a href="@ref"><code>record</code></a> function &#40;also see the <a href="/previews/PR1212/documentation/animation/index.html#animations">Animations</a> page&#41; and allow interaction by <code>sleep</code>ing in the loop.</p> <p>In this example, we sample from the Scene <code>scene</code> for 10 seconds, at a rate of 10 frames per second.</p> <pre><code class=language-julia >fps &#61; 10
record&#40;scene, &quot;test.mp4&quot;; framerate &#61; fps&#41; do io
    for i &#61; 1:100
        sleep&#40;1/fps&#41;
        recordframe&#33;&#40;io&#41;
    end
end</code></pre> <div class=page-foot > <div class=copyright > &copy; Makie.jl. Last modified: August 10, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. <p>These docs were autogenerated using Makie: v0.15.0, GLMakie: v0.4.4, CairoMakie: v0.6.3, WGLMakie: v0.4.4</p> </div> </div> </div> </div> </div> <div class=page__footer > <footer> <div class=page__footer-follow > <ul class=social-icons > <li><a href="https://twitter.com/MakiePlots" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden=true ></i> Twitter</a> <li><a href="https://github.com/JuliaPlots/Makie.jl" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i> GitHub</a> </ul> </div> <div class=page__footer-copyright >&copy; Makie.jl. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel=nofollow >Minimal Mistakes</a>.</div> </footer> </div> <script src="/previews/PR1212/libs/minimal-mistakes/main.min.js"></script> <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script> <script src="/previews/PR1212/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script>